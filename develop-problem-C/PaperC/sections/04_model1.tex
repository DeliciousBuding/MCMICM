% Section 4: Model 1 - Fan Vote Inversion (Dual-Core Engine)
% 模型一：粉丝投票反演（LP/CP 双核引擎）

\section{Model 1: Fan Vote Inversion via Dual-Core Engine}
\label{sec:model1}

\noindent\textbf{\textit{This section addresses Tasks 1--2:}} We reconstruct feasible fan vote intervals from observed eliminations, quantify the impact of rule changes (immunity, double eliminations, judge saves), and identify seasons where the stated rules cannot fully explain outcomes.

% 4.1 问题形式化
\subsection{Problem Formulation}
\label{subsec:model1_formulation}

Let $\mathcal{C}_{s,w} = \{1, 2, \ldots, n\}$ denote the set of active contestants in season $s$, week $w$. We observe:
\begin{itemize}[itemsep=0.2em]
    \item Judge scores $\mathbf{J} = (J_1, J_2, \ldots, J_n)$
    \item Elimination outcome $E \in \mathcal{C}_{s,w}$ (the contestant sent home)
    \item For percent seasons (S3--S27): aggregate vote share information
    \item For rank seasons (S1--S2, S28+): only judge ranks disclosed; \textbf{fan vote ranks are latent}
\end{itemize}

\noindent We seek to infer the latent fan vote shares $\mathbf{v} = (v_1, v_2, \ldots, v_n)$ satisfying:
\begin{equation}
    \label{eq:vote_simplex}
    \sum_{i=1}^{n} v_i = 1, \quad v_i \geq \epsilon \quad \forall i,
\end{equation}
where $\epsilon > 0$ is a minimum share floor (default: 1\%).

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{figures/fig_dual_engine.jpg}
    \caption{\textbf{Dual-Core Engine Architecture.} The LP core handles percent seasons (S3--S27) with closed-form constraints, while the MILP core handles rank seasons (S1--S2, S28--S34) requiring binary rank-ordering variables. \emph{Why two engines?} The S28+ rule change fundamentally altered the information structure---from percentage-based to rank-based disclosure.}
    \label{fig:dual_engine}
\end{figure}

% 4.2 百分比披露季（LP 核心）
\subsection{Percent Seasons: Linear Programming Core}
\label{subsec:lp_core}

For percent-rule seasons S3--S27, where combined scores are defined by a percentage-based rule (fan shares remain unobserved), we formulate fan vote inference as a \textbf{Linear Programming (LP) feasibility problem}.

\subsubsection{Elimination Constraint}
Under the standard DWTS rule, the contestant with the lowest combined score (judge percentage + fan percentage) is eliminated. The judge percentage for contestant $i$ is:
\begin{equation}
    \label{eq:judge_pct}
    J_i^{\%} = \frac{J_i}{\displaystyle\sum_{k \in \mathcal{C}_{s,w}} J_k}.
\end{equation}
The combined score is:
\begin{equation}
    \label{eq:combined_score}
    C_i = J_i^{\%} + v_i.
\end{equation}
The elimination constraint ($E$ has the lowest combined score):
\begin{equation}
    \label{eq:elimination_constraint}
    C_E \leq C_i \quad \forall i \neq E.
\end{equation}

Substituting and rearranging:
\begin{equation}
    \label{eq:lp_elimination}
    v_E - v_i \leq \frac{J_i - J_E}{\displaystyle\sum_{k} J_k} \quad \forall i \neq E.
\end{equation}

\subsubsection{Robust LP Formulation}
\label{subsubsec:robust_lp}

In practice, strict feasibility may fail due to measurement noise, undisclosed rule modifications, or model specification gaps. We introduce \textbf{slack variables} $\mathbf{s} = (s_1, s_2, \ldots, s_m)$ to relax the $m$ elimination constraints, formulating the \textbf{Robust LP}:

\begin{equation}
    \label{eq:robust_lp}
    \boxed{
    \begin{aligned}
        S^* = \min_{\mathbf{v}, \mathbf{s}} \quad & \sum_{k=1}^{m} s_k \\
        \text{s.t.} \quad & \sum_{i=1}^{n} v_i = 1 \\
        & v_i \geq \epsilon \quad \forall i \\
        & s_k \geq 0 \quad \forall k \\
        & v_E - v_i \leq \frac{J_i - J_E}{\displaystyle\sum_{k} J_k} + s_k \quad \forall k \in \{1, \ldots, m\}
    \end{aligned}
    }
\end{equation}

\noindent where:
\begin{itemize}[itemsep=0.2em]
    \item $S^* = \sum_k s_k$ is the \textbf{Minimum Inconsistency Score}---the smallest total constraint violation required to achieve feasibility. Since $s_k \geq 0$, no absolute value is needed.
    \item $\epsilon > 0$ is the \textbf{relaxation parameter} (minimum vote floor, default 1\%).
    \item $s_k \geq 0$ allows the $k$-th elimination constraint to be violated by amount $s_k$.
\end{itemize}

\noindent\textbf{Interpretation:}
\begin{itemize}[itemsep=0.2em]
    \item $S^* = 0$: The system is \emph{feasible}---eliminations are fully explainable by fan votes and judge scores.
    \item $S^* > 0$: The system exhibits \emph{model-data mismatch}---some factor not captured by our model is required to explain the observed outcomes. This could be undocumented rule variations, judge save subjectivity (S28+), or data aggregation differences.
\end{itemize}

\subsubsection{Bounding via LP}
Given a feasible (or minimally relaxed) constraint set, we compute tight bounds on each $v_i$:
\begin{equation}
    \label{eq:lp_bounds}
    v_i^{\min} = \min_{\mathbf{v}} v_i, \quad v_i^{\max} = \max_{\mathbf{v}} v_i
\end{equation}
subject to constraints \eqnref{eq:vote_simplex}, \eqnref{eq:lp_elimination}, and $\sum_k s_k \leq S^* + \delta$.

% 4.3 排名披露季（CP 核心）
\subsection{Rank Seasons: Mixed-Integer Linear Programming}
\label{subsec:milp_core}

For seasons S1--S2 and S28--S34, only judge rankings are disclosed; \textbf{fan vote ranks are latent variables}. We model fan ranks as \textbf{decision variables} using MILP.

\subsubsection{MILP Formulation}
Let $x_{ik} \in \{0,1\}$ indicate whether contestant $i$ has fan rank $k$. The constraints:
\begin{align}
    \sum_{k=1}^{n} x_{ik} &= 1 \quad \forall i \quad \text{(each contestant has exactly one rank)} \label{eq:one_rank}\\
    \sum_{i=1}^{n} x_{ik} &= 1 \quad \forall k \quad \text{(each rank assigned to exactly one contestant)} \label{eq:rank_unique}\\
    r_i^{\text{fan}} &= \sum_{k=1}^{n} k \cdot x_{ik} \quad \text{(define fan rank)} \label{eq:fan_rank_def}
\end{align}

The \textbf{elimination constraint} under rank rules: the eliminated contestant must be in the \textbf{bottom-two} by combined rank $R_i = r_i^{\text{judge}} + r_i^{\text{fan}}$. Let $R_{(n-1)}$ denote the second-highest combined rank. We require:
\begin{equation}
    \label{eq:rank_elim}
    R_E \geq R_{(n-1)} \quad \text{(eliminated is in bottom-two by combined rank)}
\end{equation}
This is weaker than ``eliminated has the worst rank''---it allows for Judge Save to determine which of the bottom-two is actually eliminated.

\noindent We model contestant eligibility via an FSM with states $\{\texttt{ACTIVE}, \texttt{IMMUNE}, \texttt{SAVED}, \texttt{ELIMINATED}\}$.

\subsubsection{Modeling Scope for Judge Save (S28+)}
\label{subsubsec:judge_save_scope}

Starting S28, DWTS introduced the \textbf{Judges' Save} rule: after bottom-two contestants are identified via combined ranks, judges vote live to save one (source: problem statement). We explicitly \emph{do not model} the judges' live decision:
\begin{enumerate}[itemsep=0.1em]
    \item \textbf{Unobserved criteria:} Judge save decisions depend on subjective factors (artistry, improvement trajectory) not captured by scores alone.
    \item \textbf{Data limitation:} We observe only the final eliminated contestant, not which two were in the bottom.
\end{enumerate}

\noindent\textbf{What we model:} Given the observed elimination $E_w$, we infer fan vote ranks such that $E_w$ could plausibly have been in the bottom-two under rank-combination rules. When $S^* > 0$ for S28--S34, the mismatch may arise from: (1) the eliminated contestant was not actually in the bottom-two, (2) multi-dance score aggregation differs from assumptions, or (3) rule implementation details are undocumented. This is an \textbf{assumption boundary}, not model failure.

% 4.4 规则自适应约束生成
\subsection{Rule-Adaptive Constraints}

\begin{table}[H]
    \centering
    \caption{Rule Changes Across DWTS Seasons}
    \label{tab:rule_changes}
    \begin{tabular}{llp{7cm}}
        \toprule
        \textbf{Seasons} & \textbf{Rule} & \textbf{Constraint Modification} \\
        \midrule
        S1--S2 & Rank-only & Use MILP core (\S\ref{subsec:milp_core}) \\
        S3--S27 & Percent & Standard LP (\S\ref{subsec:lp_core}) \\
        S28+ & Rank + Judge Save & MILP + scope limitation (\S\ref{subsubsec:judge_save_scope}) \\
        Various & Double elim/Immunity & Adjust active set \\
        \bottomrule
    \end{tabular}
\end{table}

% 4.5 核心功能：规则透明度检测器
\subsection{Core Feature: Rule Transparency Detector}
\label{subsec:mismatch_detection}

A key innovation of our framework is its ability to \textbf{automatically detect rule opacity}---episodes where the stated scoring rules cannot fully explain the observed outcome. We frame this not as model failure, but as a \textbf{diagnostic feature}: the Dual-Core Engine functions as a ``lie detector'' for rule consistency.

\begin{tcolorbox}[colback=dwts-proposed!10!white, colframe=dwts-proposed!80!black, title=\textbf{Key Insight: Mismatch as Feature, Not Bug}]
When our system reports $S^* > 0$, it has \emph{successfully identified} that something beyond the published rules influenced the elimination. This is precisely the information a network executive needs to prepare for media scrutiny.
\end{tcolorbox}

\noindent\textbf{Technical Implementation.} We compute the \textbf{Mismatch Indicator} $S^*(\epsilon)$---the minimum constraint violation required for feasibility, analogous to anomaly detection in constraint satisfaction \cite{chandola2009anomaly}:
\begin{itemize}[itemsep=0.1em]
    \item \emph{Percent seasons} (S3--S27): $S^*$ is the optimal objective of the Robust LP (\eqnref{eq:robust_lp}).
    \item \emph{Rank seasons} (S1--S2, S28--S34): $S^*$ is defined via MILP slack on the bottom-two constraint (\eqnref{eq:rank_elim}).
\end{itemize}

\noindent\textbf{Interpretation Protocol:}
\begin{itemize}[itemsep=0.1em]
    \item $S^* = 0$: \textcolor{dwts-proposed}{\textbf{Green Light}}---eliminations are fully explainable; no controversy expected.
    \item $S^* > 0$: \textcolor{dwts-warning}{\textbf{Red Flag}}---the system has detected rule opacity. Prepare explanatory materials.
\end{itemize}

\noindent\textbf{Aggregation:} We use $S^* = \max_w s_w$ (worst-week slack per season) for cross-season comparability. Units: percentage-point gap for percent seasons; rank-gap for rank seasons.

\figref{fig:money_plot} presents our central diagnostic: the ``Rule Transparency Audit'' across all 34 seasons.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/fig_anomaly_detection.pdf}
    \caption{\textbf{Rule Transparency Audit.} The Mismatch Indicator $S^*$ across 34 DWTS seasons. Seasons 1--31 pass the consistency check ($S^* = 0$). \textbf{Seasons 32--33 trigger alerts}, indicating outcomes that cannot be explained by publicly stated rules alone. This is a \emph{feature}: the system successfully detected rule opacity introduced by the Judges' Save mechanism.}
    \label{fig:money_plot}
\end{figure}

\subsubsection{The Black Box of Seasons 32--33: When Math Fails to Explain Reality}
\label{subsubsec:s32_blackbox}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.85\textwidth]{figures/fig1_inconsistency_spectrum.pdf}
    \caption{\textbf{Mismatch Spectrum.} S32 ($S^*=2.0$) and S33 ($S^*=1.0$) exhibit elevated slack values, marking them as ``black box'' seasons where stated rules are insufficient to explain outcomes. Note: slack units differ between rule eras; shown for flag identification, not magnitude comparison.}
    \label{fig:inconsistency}
\end{figure}

\noindent\textbf{What the Math Tells Us:} Even after optimizing over \emph{all possible} fan-rank permutations (a combinatorial search), some weeks in S32--S33 require positive slack. No fan vote distribution exists that places the eliminated contestant in the bottom-two under rank-combination rules. The mismatch is \emph{structural}.

\noindent\textbf{What This Means for DWTS:}
\begin{enumerate}[itemsep=0.1em]
    \item The Judges' Save rule (S28+) introduces a \textbf{``discretionary black box''}---save decisions depend on subjective criteria (improvement, artistry) not derivable from scores.
    \item When media or fans question an ``upset'' result in S32/S33, the honest answer is: \emph{``The judges exercised discretion beyond the numerical rankings.''}
    \item Our system provides \textbf{advance warning}: run the checker before broadcast, and prepare talking points for flagged episodes.
\end{enumerate}

\begin{tcolorbox}[colback=dwts-warning2!15!white, colframe=dwts-warning!80!black, title=\textbf{Actionable Insight for Producers}]
\textbf{S32--S33 are not errors in our model---they are successful detections of rule ambiguity.} The Judges' Save mechanism, while adding dramatic tension, reduces outcome predictability. Consider publishing save criteria (e.g., ``cumulative improvement score'') to restore transparency.
\end{tcolorbox}

% 4.6 结果汇总
\subsection{Summary}

\begin{itemize}[itemsep=0.2em]
    \item \textbf{Coverage:} 32 of 34 seasons are feasible at $\epsilon=1\%$; the only infeasible seasons are \textbf{S32} and \textbf{S33}.
    \item \textbf{Mismatch Signals:} S32 ($S^*=2.0$) and S33 ($S^*=1.0$) exhibit positive slack, indicating assumption-data tension warranting further investigation.
    \item \textbf{Bound Tightness:} Median interval width $v_i^{\max} - v_i^{\min} = 8.3\%$ across all contestant-weeks.
    \item \textbf{Point Estimates:} We use interval midpoints $\hat{v}_i = (v_i^{\min} + v_i^{\max}) / 2$ for downstream analysis.
\end{itemize}


