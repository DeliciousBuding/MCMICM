% Appendix A: Key Code
\section*{Appendix A: Key Code}
\addcontentsline{toc}{section}{Appendix A: Key Code}
\label{appendix:code}

Core algorithms are summarized below; full code available in supplementary materials.

\subsection*{A.1 LP Inversion Engine (Simplified)}

\begin{lstlisting}[language=Python, caption={LP fan vote bound computation}]
def compute_bounds(judge_scores, eliminated_idx, eps=0.01):
    n, j_bar = len(judge_scores), np.mean(judge_scores)
    A_ub, b_ub = [], []
    for i in range(n):
        if i != eliminated_idx:
            c = np.zeros(n); c[eliminated_idx], c[i] = 1, -1
            A_ub.append(c)
            b_ub.append((judge_scores[i]-judge_scores[eliminated_idx])/j_bar)
    bounds = [(eps, 1.0) for _ in range(n)]
    results = {}
    for i in range(n):
        c_min = np.zeros(n); c_min[i] = 1
        res = linprog(c_min, A_ub, b_ub, [[1]*n], [1], bounds)
        results[i] = res.fun if res.success else None
    return results
\end{lstlisting}

\subsection*{A.2 Cox Proportional Hazards}

\begin{lstlisting}[language=Python, caption={Survival analysis}]
from lifelines import CoxPHFitter
model = CoxPHFitter()
model.fit(df[['weeks','eliminated','judge_score','fan_vote','celeb_type']],
          duration_col='weeks', event_col='eliminated')
hazard_ratios = np.exp(model.summary['coef'])
\end{lstlisting}

\subsection*{A.3 Weighted Borda Mechanism}

\begin{lstlisting}[language=Python, caption={Borda counterfactual}]
def borda_score(j_scores, v_shares, alpha=0.6):
    j_norm = (j_scores - j_scores.min()) / (j_scores.ptp() + 1e-8)
    v_norm = (v_shares - v_shares.min()) / (v_shares.ptp() + 1e-8)
    return alpha * j_norm + (1-alpha) * v_norm
\end{lstlisting}
